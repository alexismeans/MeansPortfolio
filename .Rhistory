shrub <- quality %>%
filter(FunctionalGroup %in% c("ES", "S", "T", "V"))
shrub.list <- plant %>%
filter(FunctionalGroup %in% c("ES", "S", "T", "V"))
shrub.list <- plant %>%
filter(FG %in% c("ES", "S", "T", "V"))
datatable(shrub.list, options = list(pageLength = 10))
p3 <- ggplot(shrub, aes(
x = DE,
y = DP,
color = Status,
text = paste0(
"Spp: ", Spp,
"<br>Pheno: ", Pheno,
"<br>Part: ", Part,
"<br>Status: ", Status,
"<br>DE: ", round(DE, 2),
"<br>DP: ", round(DP, 2)
)
)) +
geom_point(size = 4, color = "#12bec7") +
geom_vline(xintercept = 11.5, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 7.5, linetype = "dashed", color = "gray50") +
labs(
title = "Overall Quality Metrics of Observed Shrubs/Trees",
x = "DE",
y = "DP",
color = "Status"
) +
theme_minimal(base_size = 12)
p3_plotly <- ggplotly(p3, tooltip = "text") %>%
layout(
legend = list(
title = list(text = ""),
orientation = "h",   # horizontal
x = 0.5,             # center horizontally
y = -0.2,            # below the x-axis
xanchor = "center",
yanchor = "top"
)
)
p3_plotly
#| warning: FALSE
#| message: false
ggplot(shrub, aes(x = DE, y = DP)) +
geom_point(aes(color = Status), size = 3) +
geom_text_repel(aes(label = paste(Spp, Pheno, sep = "_")), size = 3) +
xlim(11, max(grass$DE) + 0.5) +
ylim(7, max(grass$DP) + 0.5) +
labs(
title = "Top Shrub or Tree Species",
x = "DE",
y = "DP",
color = "Status"
) +
theme_minimal(base_size = 12)
invasive <- ggplot(grass, aes(
x = DE,
y = DP,
color = Status,
text = paste0(
"Spp: ", Spp,
"<br>Pheno: ", Pheno,
"<br>Part: ", Part,
"<br>Status: ", Status,
"<br>DE: ", round(DE, 2),
"<br>DP: ", round(DP, 2)
)
)) +
geom_point(size = 3) +
facet_wrap(~Status, scales = "fixed") +
geom_vline(xintercept = 11.5, linetype = "dashed", color = "gray50") +
geom_hline(yintercept = 7.5, linetype = "dashed", color = "gray50") +
labs(
title = "Grass Quality Metrics by Status",
x = "DE",
y = "DP"
) +
coord_cartesian(xlim = c(9, 14), ylim = c(-2, 12)) +
theme_minimal(base_size = 12)
ggplotly(invasive, tooltip = "text")
status <- plant %>%
select(Spp, Status, FunctionalGroup)
install.packages("ggrepel")
ggplot(shrub, aes(x = DE, y = DP)) +
geom_point(aes(color = Status), size = 3) +
geom_text(aes(label = paste(Spp, Pheno, sep = "_")),
size = 3,
vjust = -0.5,    # Adjust vertical position
hjust = 0.5) +   # Adjust horizontal position
xlim(11, max(grass$DE) + 0.5) +
ylim(7, max(grass$DP) + 0.5) +
labs(
title = "Top Shrub or Tree Species",
x = "DE",
y = "DP",
color = "Status"
) +
theme_minimal(base_size = 12)
p <- ggplot(shrub, aes(x = DE, y = DP, text = paste(Spp, Pheno, sep = "_"))) +
geom_point(aes(color = Status), size = 3) +
labs(title = "Top Shrub or Tree Species", x = "DE", y = "DP")
ggplotly(p, tooltip = "text")
#| warning: FALSE
#| message: false
p <- ggplot(forb, aes(x = DE, y = DP, text = paste(Spp, Pheno, sep = "_"))) +
geom_point(aes(color = Status), size = 3) +
xlim(11, max(grass$DE) + 0.5) +
ylim(7, 18) +
labs(
title = "Top Forb Species",
x = "DE",
y = "DP",
color = "Status"
) +
theme_minimal(base_size = 12)
# Convert to interactive plotly
ggplotly(p, tooltip = "text")
#| warning: FALSE
#| message: false
library(plotly)
p <- ggplot(grass, aes(x = DE, y = DP, text = paste(Spp, Pheno, sep = "_"))) +
geom_point(aes(color = Status), size = 3) +
xlim(11, max(grass$DE) + 0.5) +
ylim(7, max(grass$DP) + 0.5) +
labs(
title = "Top Grass Species",
x = "DE",
y = "DP",
color = "Status"
) +
theme_minimal(base_size = 12)
# Convert to interactive plotly
ggplotly(p, tooltip = "text")
View(grass)
status <- plant %>%
rename(Code = Spp) %>%
select(Spp, Status, FunctionalGroup)
status <- plant %>%
rename(Spp = Code) %>%
select(Spp, Status, FunctionalGroup)
status <- plant %>%
rename(Spp = Code) %>%
select(Spp, Status, FG)
df <- comp %>%
left_join(status, by = "Spp")
df <- df %>%
mutate(Pheno = na_if(Status, "NA")) %>%
filter(!is.na(Status)) %>%
mutate(PVT = dplyr::recode(PVT,
`672` = "Grassland",
`682` = "Riparian",
`668` = "Scabland",
`669` = "Shrubland",
`674` = "Intermediate",
`660` = "Sparse"))
df %>%
count(Month, Status) %>%
group_by(Month) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = Month, y = prop, fill = Status)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Status Composition based on Month",
x = "Month",
y = "Proportion",
fill = "Status"
) +
theme_minimal()
#| warning: FALSE
fecal.loc <- fecal %>%
filter(!is.na(LAT) & !is.na(LONG)) %>%
filter(!ID %in% c("25_045", "25_061", "25_048")) %>%
st_as_sf(coords = c("LONG", "LAT"), crs = 4326)
df %>%
count(PVT, Status) %>%
group_by(PVT) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = PVT, y = prop, fill = Status)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Status Composition based on Vegetation Type",
x = "Potential Vegetation Type",
y = "Proportion",
fill = "Status"
) +
theme_minimal()
#| warning: FALSE
f <- "C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Fecal.xlsx"
fecal <- read_excel(f, "Sheet1")
fecal.time <- fecal %>%
filter(!ID %in% c("25_045", "25_061")) %>%
mutate(
DATE = as.Date(
suppressWarnings(as.numeric(DATE)),
origin = "1899-12-30"
)
) %>%
filter(!is.na(DATE)) %>%
distinct(DATE, .keep_all = TRUE) %>%
mutate(
DOY  = yday(DATE),
Year = factor(year(DATE))
)
ggplot(fecal.time, aes(x = DOY, y = Year, color = Year)) +
geom_jitter(height = 0.2, size = 3) +
scale_x_continuous(
breaks = c(1, 32, 61, 92, 122, 153, 183, 213),
labels = c("Jan", "Feb", "March", "Apr", "May", "June", "July", "Aug")
) +
labs(
title = "Sampling Dates by Year",
x = "Month",
y = "Year",
color = "Year"
) +
theme_bw()
#| warning: FALSE
fecal.loc <- fecal %>%
filter(!is.na(LAT) & !is.na(LONG)) %>%
filter(!ID %in% c("25_045", "25_061", "25_048")) %>%
st_as_sf(coords = c("LONG", "LAT"), crs = 4326)
View(fecal)
fecal.time <- fecal %>%
filter(!ID %in% c("25_JDR_093", "25_JDR_094")) %>%
mutate(
DATE = as.Date(
suppressWarnings(as.numeric(DATE)),
origin = "1899-12-30"
)
) %>%
filter(!is.na(DATE)) %>%
distinct(DATE, .keep_all = TRUE) %>%
mutate(
DOY  = yday(DATE),
Year = factor(year(DATE))
)
ggplot(fecal.time, aes(x = DOY, y = Year, color = Year)) +
geom_jitter(height = 0.2, size = 3) +
scale_x_continuous(
breaks = c(1, 32, 61, 92, 122, 153, 183, 213),
labels = c("Jan", "Feb", "March", "Apr", "May", "June", "July", "Aug")
) +
labs(
title = "Sampling Dates by Year",
x = "Month",
y = "Year",
color = "Year"
) +
theme_bw()
#| warning: FALSE
fecal.loc <- fecal %>%
filter(!is.na(LAT) & !is.na(LONG)) %>%
filter(!ID %in% c("25_JDR_093", "25_JDR_094", "25_JDR_024")) %>%
st_as_sf(coords = c("LONG", "LAT"), crs = 4326)
jd <- st_transform(st_zm(jd), crs = 4326)
river <- st_transform(st_zm(river), crs = 4326)
river <- st_intersection(river, jd)
ggplot() +
geom_sf(data = jd, fill = NA, color = "black", size = 0.6) +
geom_sf(data = river, color = "blue", size = 0.8) +
geom_sf(data = fecal.loc, aes(color = QUALITY), size = 2, alpha = 0.8) +
labs(
title = "Sample Locations within the John Day",
x = "Longitude",
y = "Latitude",
color = "Sample Freshness"
) +
theme_minimal() +
theme(legend.position = "right") +
scale_x_continuous(
breaks = pretty(range(st_coordinates(jd)[,1]), n = 3)
) +
scale_y_continuous(
breaks = pretty(range(st_coordinates(jd)[,2]), n = 3)
)
library(tidyverse)
library(lubridate)
library(sf)
setwd("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/")
totals <- read.csv("test.totals.csv")
fdata <- read.csv("test.fdata.csv")
transect <- read.csv("../raw.data/transect.csv") #formatting plot database
plot <- transect %>% rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>% select(Dates, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate(Dates = mdy(Dates), JulianDay = yday(Dates)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
#formatting fdata
fdata <- fdata %>% select(-Max, -Pct_Used, -SuitableBiomass)
#combine all the databases
data <- plot %>%
left_join(y = totals, by = "TransectID") %>%
left_join(y = fdata, by = "TransectID", relationship = "one-to-many")
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
select(JulianDay, PVT, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
#recategorize PVT
data <- data %>%
mutate(PVT = recode(PVT, `672` = "Grassland", `668` = "Scabland", `669` = "Sagebrush Shrubland", `674` = "Sagebrush Steppe", `682` = "Riparian"))
rm(fdata, plot, totals, transect)
# Calculate the percent of biomass relative to each PVT's total biomass percent
percentdata <- data %>% group_by(PVT) %>%
mutate( total_biomass = sum(SuitableBiomass, na.rm = TRUE),  # Total biomass in each PVT
percent_biomass = SuitableBiomass / total_biomass * 100 # Percent biomass relative to total biomass in PVT
) %>% ungroup()
# Boxplot for percent biomass
ggplot(percentdata, aes(x = PVT, y = percent_biomass, fill = PVT)) +
geom_boxplot() +
labs(title = "% Suitable Biomass Relative to Total Suitable Biomass by PVT", x = "PVT", y = "Percent Suitable Biomass") +
theme_minimal() + theme(legend.position = "none")
# Create the boxplot
ggplot(data, aes(x = PVT, y = SuitableBiomass, fill = PVT)) +
geom_boxplot() +
labs(title = "% Suitable Biomass Relative to Total Suitable Biomass by PVT", x = "PVT", y = "Suitable Biomass per PVT") +
theme_minimal() +
theme(legend.position = "none")
setwd("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/")
t <- ("total.results.xlsx")
totals <- read_excel(t,"Plot-Level-Summary")
setwd("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/")
t <- ("total.results.xlsx")
totals <- read_excel(t,"Plot-Level-Summary")
t <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.results.xlsx")
totals <- read_excel(t,"Plot-Level-Summary")
fdata <- read.csv("total.fdata.csv")
fdata <- read.csv("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.fdata.csv")
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>% rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>% select(Dates, TransectID, PVT, Lat, Long)
plot <- transect %>% rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>% select(Date, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate(Dates = mdy(Dates), JulianDay = yday(Dates)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
plot <- plot %>%
mutate(Date = mdy(Date), JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>% rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong, Day = Date) %>% select(Date, TransectID, PVT, Lat, Long)
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>% rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong, Day = Date) %>% select(Day, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate(Day = mdy(Day), JulianDay = yday(Day)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
View(plot)
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long) %>%
mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
plot <- plot %>%
mutate(Date = mdy(Day), JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
plot <- plot %>%
mutate(Date = mdy(Date), JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long) %>%
mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
plot <- plot %>%
mutate(Date = mdy(Date), JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long) %>%
mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long)
#Date = mdy(Date),
plot <- plot %>%
mutate( JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
#formatting fdata
fdata <- fdata %>% select(-Max, -Pct_Used, -SuitableBiomass)
#combine all the databases
data <- plot %>%
left_join(y = totals, by = "TransectID") %>%
left_join(y = fdata, by = "TransectID", relationship = "one-to-many")
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
select(JulianDay, PVT, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
t <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.results.xlsx")
fdata <- read.csv("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.fdata.csv")
fdata <- read.csv("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.fdata.csv")
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate( JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
View(fdata)
#formatting fdata
fdata <- fdata %>% select(-Max, -Pct_Used, -SuitableBiomass)
#combine all the databases
data <- plot %>%
left_join(y = totals, by = "TransectID") %>%
left_join(y = fdata, by = "TransectID", relationship = "one-to-many")
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
select(JulianDay, PVT, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
View(data)
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
rename(PVT = PVT.x) %>%
select(PVT.y)
data <- data %>%
select(JulianDay, PVT, PVT_Observed, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
```{r}
data <- data %>%
select(JulianDay, PVT, PVT_Observed, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
t <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.results.xlsx")
fdata <- read.csv("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.fdata.csv")
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate( JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
#formatting fdata
fdata <- fdata %>% select(-Max, -Pct_Used, -SuitableBiomass)
#combine all the databases
data <- plot %>%
left_join(y = totals, by = "TransectID") %>%
left_join(y = fdata, by = "TransectID", relationship = "one-to-many")
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
rename(PVT = PVT.x) %>%
select(-PVT.y)
data <- data %>%
select(JulianDay, PVT, PVT_Observed, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
#recategorize PVT
data <- data %>%
mutate(PVT = recode(PVT, `672` = "Grassland", `668` = "Scabland", `669` = "Shrubland", `674` = "Intermediate", `682` = "Riparian", `100` = "Fall"))
library(tidyverse)
library(lubridate)
library(sf)
t <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.results.xlsx")
totals <- read_excel(t,"Plot-Level-Summary")
fdata <- read.csv("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/R code/FRESH/processed.data/total.fdata.csv")
a <- ("C:/Users/Alexis Means/Documents/Project/Nutrition Sampling/VegDatabases/Working.composition.data.xlsx")
transect <- read_excel(a, "Transect")
plot <- transect %>%
rename(TransectID = PlotID, Lat = BeginLat, Long = BeginLong) %>%
select(Date, TransectID, PVT, Lat, Long)
plot <- plot %>%
mutate( JulianDay = yday(Date)) %>%
st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
st_transform(crs = 32611) %>%
mutate(Easting = st_coordinates(.)[,1], Northing = st_coordinates(.)[,2]) %>% select(JulianDay, TransectID, PVT, Easting, Northing) %>% st_drop_geometry()
#formatting fdata
fdata <- fdata %>% select(-Max, -Pct_Used, -SuitableBiomass)
#combine all the databases
data <- plot %>%
left_join(y = totals, by = "TransectID") %>%
left_join(y = fdata, by = "TransectID", relationship = "one-to-many")
#I hate the way it is arranged, so I am going to rearrange it
data <- data %>%
rename(PVT = PVT.x) %>%
select(-PVT.y)
data <- data %>%
select(JulianDay, PVT, PVT_Observed, TransectID, Plant.Code, Phenology, Part, Biomass, Biomass_Used, Pct_Suitable_Biomass, SuitableBiomass, DE, TotalDE, AveDE, DP, TotalDP, AveDP, Easting, Northing)
#recategorize PVT
data <- data %>%
mutate(PVT = recode(PVT, `672` = "Grassland", `668` = "Scabland", `669` = "Shrubland", `674` = "Intermediate", `682` = "Riparian", `100` = "Fall", `660`= "Sparse"))
rm(fdata, plot, totals, transect)
# Calculate the percent of biomass relative to each PVT's total biomass percent
percentdata <- data %>% group_by(PVT) %>%
mutate( total_biomass = sum(SuitableBiomass, na.rm = TRUE),  # Total biomass in each PVT
percent_biomass = SuitableBiomass / total_biomass * 100 # Percent biomass relative to total biomass in PVT
) %>% ungroup()
# Boxplot for percent biomass
ggplot(percentdata, aes(x = PVT, y = percent_biomass, fill = PVT)) +
geom_boxplot() +
labs(title = "% Suitable Biomass Relative to Total Suitable Biomass by PVT", x = "PVT", y = "Percent Suitable Biomass") +
theme_minimal() + theme(legend.position = "none")
# Create the boxplot
ggplot(data, aes(x = PVT, y = SuitableBiomass, fill = PVT)) +
geom_boxplot() +
labs(title = "% Suitable Biomass Relative to Total Suitable Biomass by PVT", x = "PVT", y = "Suitable Biomass per PVT") +
theme_minimal() +
theme(legend.position = "none")
